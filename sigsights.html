<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fastly SigSights</title>

    <link rel="shortcut icon" href="../favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="static/css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <script src="https://cdn.plot.ly/plotly-2.20.0.min.js" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="sigsights-utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>

    <script>

        function showSiteAttackCharts(attackData) {
            for (const site of Object.keys(attackData)) {
                const siteData = attackData[site];
                const chartDiv = siteData.name.replaceAll(".", "") + 'SiteAttackSignalsChart';
                
                const data = siteData.topAttackTypes.map(type => ({
                    x: [type.tagName],
                    y: [type.tagCount],
                    name: type.tagName,
                    type: 'bar'
                }));

                Plotly.newPlot(chartDiv, data, defaultStackBarChartLayout(), defaultChartOptions());
            }
        }

        function showSiteAttackPathTable(siteName, attackData) {
            const locator = `#${siteName}SiteAttackPathsTable`;
            
            // Construct the table using an array for better performance
            const tableRows = attackData.data.map(row => `
                <tr>
                    <td></td>
                    <td>${row.value}</td>
                </tr>
            `).join('');

            const table = `
                <table class="table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Path</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
            `;

            $(locator).append(table);
        }

        function showSiteOutdatedAgentsTable(siteName, d) {
            const locator = `#${siteName}SiteOutdatedAgents`;

            // Construct the table header
            const tableHeader = `
                <thead>
                    <tr>
                        <th></th>
                        <th>Agent Name</th>
                        <th>Agent Version</th>
                        <th>Agent Versions Behind</th>
                    </tr>
                </thead>
            `;

            // Construct the table rows using filter and map for clarity
            const tableRows = d.data
                .filter(row => row['agent.versions_behind'] >= 10)
                .map(row => `
                    <tr>
                        <td></td>
                        <td>${row['agent.name']}</td>
                        <td>${row['agent.version']}</td>
                        <td>${row['agent.versions_behind']}</td>
                    </tr>
                `)
                .join('');

            const table = `
                <table class="table">
                    ${tableHeader}
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
            `;

            $(locator).append(table);
        }

        function showSiteAttackPathChart(siteName, attackData) {
            const chartDiv = `${siteName}SiteAttackPathsChart`;
            
            // Construct the data for the chart using map
            const data = attackData.data.map(path => ({
                x: [path.value],
                y: [path.count],
                name: path.value,
                type: 'bar'
            }));

            // Check if the chartDiv exists before plotting
            if ($(`#${chartDiv}`).length) {
                Plotly.newPlot(chartDiv, data, defaultStackBarChartLayout(), defaultChartOptions());
            }
        }

        function siteHeader(siteName, siteDisplayName) {
            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h1 id="${siteName}">${siteDisplayName}</h1>
                    </div>
                    <div class="col"></div
                </div>
            `;
        }

        function siteTopAttackSignals(siteName, siteDisplayName) {

            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h2>Top Attack Signals Over Past 30 Days</h2>
                        <p id="${siteName}SiteAttackSignalsChart"></p>
                        <p>Visibility is critical when organizations are dealing with malicious activity across their web applications. Layer 7 attacks such as app-level DDoS, API abuse, and account takeovers pose both security and resource-utilization risks for a company and its users: these attacks can cause excessive resource consumption and impact performance across applications. Top Attack Signals gives that visibility over the past 30 days to help you focus your security efforts.</p>
                    </div>
                    <div class="col"></div>
                </div>
            `;
        }

        function siteEventsStub(siteName) {
            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h2>Sample of Site Events</h2>
                        <p>Events are actions that Signal Sciences takes as the result of regular threshold-based blocking, templated rules, and site alerts.</p>
                        <p>
                            <a href="">View Site Events</a>
                        </p>
                        <div id="${siteName}SiteEvents"></div>
                    </div>
                    <div class="col"></div>
                </div>
            `;
        }

        function siteEvents(site, d) {

            const siteEventsLocator = `#${site}SiteEvents`;
            let table = `
                <table class="table">
                    <caption>The rows colored red are RFC 1918 Private network addresses space.</caption>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>Country Code</th>
                            <th>Reasons</th>
                            <th>Path</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Limit the output to the first 10 events
            const limitedData = d.data.slice(0, 10).map(row => `
                <tr>
                    <td>${row.source}</td>
                    <td>${row.remoteCountryCode}</td>
                    <td>${JSON.stringify(row.reasons)}</td>
                    <td>${encodeURI(row.exampleRequest.path)}</td>
                </tr>
            `).join('');

            table += limitedData;
            
            table += `
                    </tbody>
                </table>
            `;

            $(siteEventsLocator).append(table);
        }   

        function siteSuspiciousIpsStub(siteName) {
            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h2>Sample of Suspicious IPs</h2>
                        <p>The Suspicious IPs tab shows IP addresses from which requests containing attack payloads have originated, but the volume of attack traffic from these IPs has not exceeded the decision threshold. Once the threshold is met or exceeded, an IP address will be flagged and added to the Flagged IPs list. The Suspicious IPs tab enables you to anticipate which IPs may soon be flagged.</p>
                        <p><a href="">View Suspicious IPs</a></p>
                        <div id="${siteName}SuspiciousIps"></div>
                    </div>
                    <div class="col"></div>
                </div>
            `;
        }

        function siteSuspiciousIps(site, d) {
            const locator = `#${site}SuspiciousIps`;
            
            let table = `
                <table class="table">
                    <caption>The rows colored red are RFC 1918 Private network addresses space.</caption>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>Country Code</th>
                            <th>Remote Hostname</th>
                            <th>Signals</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Construct table rows using map for clarity
            const tableRows = d.data.map(row => `
                <tr>
                    <td>${row.source}</td>
                    <td>${row.remoteCountryCode}</td>
                    <td>${row.remoteHostname}</td>
                    <td>${row.tagName}</td>
                </tr>
            `).join('');

            table += tableRows;

            table += `
                    </tbody>
                </table>
            `;

            $(locator).append(table);
        }


        function siteTopAttackPathsStub(siteName) {
            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h2>Top Attacked Paths</h2>
                        <p>Attack Path Management allows organizations to directly address the risk of Attack Paths at precise Choke Points.</p>
                        <p id="${siteName}SiteAttackPathsChart"></p>
                        <p id="${siteName}SiteAttackPathsTable"></p>
                    </div>
                    <div class="col"></div>
                </div>
            `;
        }

        function siteOutdatedAgentsStub(siteName) {
            return `
                <div class="row">
                    <div class="col"></div>
                    <div class="col-6">
                        <h2>Agents with Outdated Version</h2>
                        <p id="${siteName}SiteOutdatedAgents"></p>
                    </div>
                    <div class="col"></div>
                </div>
            `;
        }

        function showAttackChart(d) {
            const newData = attackChartDataPrep(d);

            const data = [{
                values: newData.values,
                labels: newData.labels,
                type: 'pie',
                textinfo: 'label'
            }];

            const layout = {
                ...defaultChartLayout(),
                showlegend:false
            };

            Plotly.newPlot('globalAttackChartContainer', data, layout, defaultChartOptions());
        }

        function showAllRequestsChart(d) {
            let totalRequestsData, totalAttacksData, totalBlockedData;

            for (const type in d) {
                const requestData = meltRequestData(d[type]);
                switch (d[type].type) {
                    case "requests_total":
                        totalRequestsData = { ...requestData, yaxis: 'y1', name: 'Total Requests' };
                        break;
                    case "requests_attack":
                        totalAttacksData = { ...requestData, yaxis: 'y2', name: 'Attacks' };
                        break;
                    case "requests_total_blocked":
                        totalBlockedData = { ...requestData, yaxis: 'y2', name: 'Blocked' };
                        break;
                }
            }

            const data = [totalRequestsData, totalAttacksData, totalBlockedData];
            
            const layout = {
                ...defaultChartLayout(),
                yaxis: { title: 'Total Requests' },
                yaxis2: {
                    title: 'Attacks / Blocks',
                    overlaying: 'y',
                    side: 'right'
                }
            };

            Plotly.newPlot('allRequestsChart', data, layout, defaultChartOptions());
        }

        function meltRequestData(d) {
            const { from, until, inc, data } = d;
            const recordCount = (until - from) / inc;

            const x = [];
            const y = [];
            
            for (let day in data) {
                x.push(new Date((from * 1000) + (86400 * 1000 * day)));
                y.push(data[day] / 1_000_000); // Using underscore for better readability
            }

            return {
                x,
                y,
                type: 'scatter'
            };
        }

        function fetchCorpData(corp) {
            $.ajax({
                url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}`,
                method: "GET",
                headers: HEADERS
            }).done(function(response) {
                $("#corp-overview-header").html(`${response.displayName} Corp Overview`);
                $("#toc-list").append(`<li><a href="#">${response.displayName} Corp Overview</a></li>`);
            });
        }

        function fetchSitesData(corp) {
            $.ajax({
                url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/sites`,
                method: "GET",
                headers: HEADERS
            }).done(function(response) {
                $.each(response.data, function(i, obj) {
                    const siteDisplayName = obj.displayName;
                    const siteName = obj.name.replaceAll(".", "");
                    $("#toc-list").append(`<li id="${siteName}_li"><a href="#${siteName}">${siteDisplayName}</a></li>`);
                    createSiteDiv(siteName, siteDisplayName);
                    fetchSiteDetails(corp, siteName);
                });
            });
        }

        function fetchSiteDetails(corp, siteName) {
            $.when(
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/sites/${siteName}/events`,
                    method: "GET",
                    headers: HEADERS
                }).done(function(response) {
                    siteEvents(siteName, response);
                }),
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/sites/${siteName}/suspiciousIPs`,
                    method: "GET",
                    headers: HEADERS
                }).done(function(response) {
                    siteSuspiciousIps(siteName, response);
                }),
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/sites/${siteName}/top/attacks?field=ServerNameAndPath&from=${minus1d}&limit=3&until=${datenow}`,
                    method: "GET",
                    headers: HEADERS
                }).done(function(response) {
                    showSiteAttackPathChart(siteName, response);
                    showSiteAttackPathTable(siteName, response);
                }),
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/sites/${siteName}/agents`,
                    method: "GET",
                    headers: HEADERS
                }).done(function(response) {
                    showSiteOutdatedAgentsTable(siteName, response);
                })
            );
        }

        function fetchAttackReports(corp, minus90d, datenow) {
            $.ajax({
                url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/reports/attacks?from=-30d`,
                method: "GET",
                headers: HEADERS
            }).done(function(response) {
                const topFour = sortAndChop(response.data, 4, 'blockedCount');
                showTopFourBlockedChart(topFour);

                const attackData = compressAttackData(response.data);
                const filteredAttackData = attackData.filter(row => row.countryCode !== 'private');

                $.each(filteredAttackData, function(i, row) {
                    $("#attacks-table").append(`<tr><td>${row.countryName}</td><td>${row.countryCode}</td><td class="numbers">${row.requestCount.toLocaleString()}</td></tr>`);
                });

                showAttackChart(filteredAttackData);
                showSiteAttackCharts(response.data);

                $.each(response.data, function(i, row) {
                    if (row.topAttackSources.length === 0) {
                        $(`#${row.name}_li`).remove();
                        $(`#${row.name}_div`).remove();
                    }
                });
            });
        // Fetch time series and signals
            $.when(
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/timeseries/requests?from=${minus90d}&path=requests_total&path=requests_attack&path=requests_total_blocked&until=${datenow}`,
                    method: "GET",
                    headers: HEADERS
                }).done(response => showAllRequestsChart(response.data)),
                
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/reports/signals?from=${minus90d}&signalType=attack&until=${datenow}`,
                    method: "GET",
                    headers: HEADERS
                }).done(response => showTopAttackSignalsBySite(response.data)),
                
                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/reports/signals?from=${minus90d}&signalType=anomaly&until=${datenow}`,
                    method: "GET",
                    headers: HEADERS
                }).done(response => {
                    showCveAnomalyBySiteChart(response.data);
                    showLoginAndRegistrationBySite(response.data);
                    showAnomalySignalsBySite(response.data);
                }),

                $.ajax({
                    url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/reports/signals?from=${minus90d}&signalType=corp&until=${datenow}`,
                    method: "GET",
                    headers: HEADERS
                }).done(response => showCorpSignalsBySiteChart(sortAndChop(response.data, 100, 'count')))
            );
        }

        function fetchUserData(corp) {
            $.ajax({
                url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/users`,
                method: "GET",
                headers: HEADERS
            }).done(function(response) {
                const nonActiveUsers = response.data.filter(user => user.status !== 'active');
                $.each(nonActiveUsers, function(i, row) {
                    $("#inactive-users-table").append(`<tr><td>${row.email}</td><td>${row.role}</td><td>${row.status}</td></tr>`);
                });
            });
        }

        function createSiteDiv(siteName, siteDisplayName) {
            const siteDiv = `${siteName}_div`;
            $("#sites").append(`<div class="row nextsite" id="${siteDiv}"></div>`);
            $(`#${siteDiv}`).append(siteHeader(siteName, siteDisplayName))
                            .append(siteTopAttackSignals(siteName, siteDisplayName))
                            .append(siteEventsStub(siteName))
                            .append(siteSuspiciousIpsStub(siteName))
                            .append(siteTopAttackPathsStub(siteName))
                            .append(siteOutdatedAgentsStub(siteName));
        }

        function fetchAllowRules(corp) {
            $.ajax({
                url: `https://dashboard.signalsciences.net/api/v0/corps/${corp}/rules?action=allow`,
                method: "GET",
                headers: HEADERS
            }).done(function(response) {
                $.each(response.data, function(i, row) {
                    $("#allow-rules-table").append(`
                        <tr>
                            <td>
                                <table>
                                    <tr><th>Sites</th><td>${row.siteNames.sort().join("</br>")}</td></tr>
                                    <tr><th>Enabled</th><td>${row.enabled}</td></tr>
                                    <tr><th>Reason</th><td>${row.reason}</td></tr>
                                    <tr><th width="100px">Created By</th><td>${row.createdBy}</td></tr>
                                    <tr><th>Actions</th><td>${convertActionsToHtml(row.actions)}</td></tr>
                                </table>
                            </td>
                        </tr>`);
                });
            });
        }

        function convertActionsToHtml(actions) {
            // Start the HTML string with the table structure
            let html = `
                <table class='table table-striped'>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Signal</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            // Use forEach for better readability
            actions.forEach(action => {
                const type = action.type;
                const signal = type === 'allow' ? '' : action.signal;

                html += `
                    <tr>
                        <td width='80px'>${type}</td>
                        <td>${signal}</td>
                    </tr>
                `;
            });

            // Close the table
            html += `
                    </tbody>
                </table>
            `;

            return html;
        }

        $("document").ready(function(){

            const corp =  "ebay";
            HEADERS = {
                "Content-Type": "application/json",
                "x-api-user": "rmiller+ebay@fastly.com",
                "x-api-token": "d31a6c87-7141-46b0-a80a-c859476d1151"
            }
            // get timeseries data  
            datenow = Math.floor(Date.now() / 1000);
            minus1d = (datenow - (1 * 24 * 60 * 60));
            minus90d = (datenow - (90 * 24 * 60 * 60));

            $('#sso-settings-link').attr('href', 'https://dashboard.signalsciences.net/corps/' + corp + '/settings');

            fetchCorpData(corp);
            fetchSitesData(corp);
            fetchAttackReports(corp, minus90d, datenow);
            fetchUserData(corp);
            fetchAllowRules(corp);
        });
            
    </script>
  </head>
  <body>

        <div class="container-fluid">
            <div class="row header">
                <div class="col text-center" style="background-color: red; color: white;">
                    <img src="static/img/fastly_logo_white.png" alt="fastly header" class="img-fluid" style="max-width: 300px; margin: 20px 20px 20px 20px;"/>
                    <p>Fastly Next Generation WAF Report</p>
                    <p>©2022 Fastly, Inc. | Confidential | <a href="http://www.fastly.com">fastly.com</a></p>
                    <img src="static/img/bg2.png" alt="fastly decorative header" class="img-fluid" style="max-width: 600px; margin-bottom: 20px;"/>
                </div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h1 id="toc">Table of Contents</h1>
                    <ul id="toc-list">
                    </ul>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h1 id="corp-overview-header"></h1>
                    <p>The Next-Gen WAF Report provides a high-level view of your Corp and Top Sites which see the most traffic, which sites are attacked the most, which sites are seeing the most blocked traffic and which sites we are identifying the most flagged, malicious IPs for. In addition to high-level stats, the Next-Gen WAF Report also provides a view into attack types, and their source, which helps enable your security team to understand better how your services are being attacked and the direction you should take to mitigate them.</p>
                    <div>

                        <h2>Global Attack Sources</h2>

                        <p id="globalAttackChartContainer" style="height: 800px; width: 100%;"></p>
                        <p>
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Country</th>
                                        <th>Country Code</th>
                                        <th class="numbers">Attacks</th>
                                    </tr>
                                </thead> 
                                <tbody id="attacks-table"></tbody>
                            </table>
                        </p>    
                        <p>Attack map, also known as a cyber attack map, is a visual representation of the source and destination country locations around the world generating attack traffic. It is based on real-time application layer security analysis of attack Signals we analyze and identify coming from specific countries over the last 90 days for your corp/sites.</p>
                    </div>
                </div>
                <div class="col"></div>
            </div>
                
            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>All Requests Over the Last 90 Days</h2>
                    <p id="allRequestsChart" style="height: 600px; width: 100%;"></p>
                    <p>This chart shows you the total number of requests over the previous 90 days. Here we can compare the number of attack vs blocked requests compared to the overall number of requests that your entire Corp has handled.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Top Four Sites by Blocked Requests</h2>
                    <p id="topFourSitesByBlockedRequests"></p>
                    <p>These are the Top 4 Sites/Workspaces in your Corp that have blocked requests. This will include requests that have been blocked by System Alerts, Request Rules, Rate Limit Rules, and Templated Rules.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Top <a href="https://docs.fastly.com/signalsciences/using-signal-sciences/signals/using-system-signals/#attacks">Attack Signals</a> by Site</h2>
                    <p id="topAttackSignalsBySite"></p>
                    <p>These are the top sites that have sent the most attack traffic. Attack traffic is considered to be the following signals: CMDEXE, Traversal, Backdoor, Attack Tooling, SQLI, and XSS. The default threshold for these attack signals is 50 in 1 minute. It is recommended to reduce this threshold if the application is extremely vulnerable. In some cases, it might be necessary to block these requests immediately, which can be done with a Request Rule.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Sites with CVE Anomaly Signals</h2>
                    <p id="cveAnomalyBySite"></p>
                    <p>These sites are seeing the most CVE signals. The CVE Templated Rules should be enabled in order to see data in this graph. It is recommended to turn on CVE rules to virtually patch the applications in your environment. Turning on non-relevant CVE rules is not recommended.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Sites with Login and Registration Signals</h2>
                    <p id="loginAndRegistrationBySite"></p>
                    <p>Logins and Registration signals will allow you to see whether account takeover attacks have occurred. If you see a spike in Login Failure vs Success, that could indicate a cred stuffing attempt. It is recommended to turn on as many ATO Templated Rules as possible for visibility.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Sites with Anomaly Signals</h2>
                    <p id="anomalySignalsBySite"></p>
                    <p>Anomaly Signals indicate an abnormal request, for example, the No Content-Type signal indicates the Content-Type header value is missing. This does not mean the request is an attack, but something that may need attention.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Sites with Corp Signals</h2>
                    <p id="corpSignalsBySite"></p>
                    <p>Corp Signals are signals created by individual users that have access to the Next-Gen WAF. These custom signals can be used in a Request Rule to identify requests with request header or body values.</p>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2><a id="sso-settings-link">Single Sign On</a> is enabled</h2>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Inactive User Accounts</h2>
                    <p>Increase account security by removing access for all inactive users.</p>
                    <p>In order to avoid unnecessary access to the sensitive information on your Next-Gen WAF, it's best to audit the users that have access to the application, but haven't logged in yet. For those who may not need access to the product, it is recommended to remove their access.</p>
                    <div>
                        <p>
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                    </tr>
                                </thead> 
                                <tbody id="inactive-users-table"></tbody>
                            </table>
                        </p> 
                    </div>
                </div>
                <div class="col"></div>
            </div>

            <div class="row">
                <div class="col"></div>
                <div class="col-6">
                    <h2>Corp Allow Rules</h2>
                    <p>Please review any Corp 'Allow' Rules as they take precedence</p>
                    <p>Allow rules permit traffic that is explicitly allowed. Allow rules take precedence over block rules, regardless of whether they were created at the corp or site level. <a href="">Allow/Block Precedence</a></p>
                    <div>
                        <p>
                            <table class="table table-striped" >
                                <tbody id="allow-rules-table">
                                </tbody>
                            </table>    
                        </p>
                        
                    </div>
                </div>
                <div class="col"></div>
            </div>

            <div id="sites">


            </div>

        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    </body>

</html>